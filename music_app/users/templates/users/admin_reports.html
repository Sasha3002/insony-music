{% extends "users/base.html" %}
{% block content %}

<style>
  .admin-reports-header {
    background: linear-gradient(135deg, #1a1a1a, #151515);
    border-radius: 20px;
    padding: 32px;
    margin-bottom: 32px;
    border: 1px solid #2a2a2a;
  }

  .admin-reports-title {
    font-size: 2rem;
    font-weight: 700;
    color: #fff;
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .admin-reports-subtitle {
    color: #9aa0a6;
  }

  .filter-tabs {
    display: flex;
    gap: 12px;
    margin-bottom: 32px;
    flex-wrap: wrap;
  }

  .filter-tab {
    background: linear-gradient(135deg, #1a1a1a, #151515);
    border: 1px solid #2a2a2a;
    color: #9aa0a6;
    padding: 12px 24px;
    border-radius: 12px;
    text-decoration: none;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.2s;
  }

  .filter-tab:hover {
    border-color: #3b82f6;
    color: #60a5fa;
    transform: translateY(-2px);
  }

  .filter-tab.active {
    background: linear-gradient(135deg, #2563eb, #3b82f6);
    border-color: #3b82f6;
    color: #fff;
  }

  .filter-badge {
    background: rgba(255,255,255,0.2);
    padding: 2px 8px;
    border-radius: 999px;
    font-size: 0.8rem;
  }

  .admin-report-card {
    background: linear-gradient(135deg, #1a1a1a, #151515);
    border: 1px solid #2a2a2a;
    border-radius: 16px;
    padding: 24px;
    margin-bottom: 16px;
    transition: all 0.2s;
    cursor: pointer;
  }

  .admin-report-card:hover {
    border-color: #3a3a3a;
    transform: translateY(-2px);
    box-shadow: 0 4px 16px rgba(0,0,0,0.3);
  }

  .admin-report-header {
    display: flex;
    justify-content: space-between;
    align-items: start;
    margin-bottom: 16px;
  }

  .admin-report-title {
    font-size: 1.2rem;
    font-weight: 600;
    color: #fff;
    margin-bottom: 8px;
  }

  .admin-report-user {
    color: #60a5fa;
    font-size: 0.9rem;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .report-status-badge {
    padding: 6px 14px;
    border-radius: 999px;
    font-size: 0.8rem;
    font-weight: 600;
    white-space: nowrap;
  }

  .status-pending {
    background: rgba(234, 179, 8, 0.1);
    border: 1px solid rgba(234, 179, 8, 0.3);
    color: #fbbf24;
  }

  .status-in_progress {
    background: rgba(59, 130, 246, 0.1);
    border: 1px solid rgba(59, 130, 246, 0.3);
    color: #60a5fa;
  }

  .status-resolved {
    background: rgba(16, 185, 129, 0.1);
    border: 1px solid rgba(16, 185, 129, 0.3);
    color: #10b981;
  }

  .admin-report-description {
    color: #b6bdc6;
    line-height: 1.6;
    margin-bottom: 16px;
  }

  .admin-report-meta {
    display: flex;
    gap: 20px;
    color: #6b7280;
    font-size: 0.85rem;
    flex-wrap: wrap;
  }

  .admin-report-meta span {
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .pagination {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-top: 32px;
  }

  .pagination a,
  .pagination span {
    padding: 8px 16px;
    background: #1a1a1a;
    border: 1px solid #2a2a2a;
    border-radius: 8px;
    color: #9aa0a6;
    text-decoration: none;
    transition: all 0.2s;
  }

  .pagination a:hover {
    border-color: #3b82f6;
    color: #60a5fa;
  }

  .pagination .current {
    background: linear-gradient(135deg, #2563eb, #3b82f6);
    border-color: #3b82f6;
    color: #fff;
  }
</style>

<div class="container py-4">
  
  <div class="admin-reports-header">
    <h1 class="admin-reports-title">
      <i class="bi bi-shield-check"></i>
      Panel zgłoszeń
    </h1>
    <p class="admin-reports-subtitle">Zarządzaj zgłoszeniami użytkowników</p>
  </div>

  <!-- Filter Tabs -->
  <div class="filter-tabs">
    <a href="?status=all" class="filter-tab {% if status_filter == 'all' %}active{% endif %}">
      <i class="bi bi-list"></i>
      Wszystkie
      <span class="filter-badge">{{ pending_count|add:in_progress_count|add:resolved_count }}</span>
    </a>
    <a href="?status=pending" class="filter-tab {% if status_filter == 'pending' %}active{% endif %}">
      <i class="bi bi-clock"></i>
      Oczekujące
      <span class="filter-badge">{{ pending_count }}</span>
    </a>
    <a href="?status=in_progress" class="filter-tab {% if status_filter == 'in_progress' %}active{% endif %}">
      <i class="bi bi-gear"></i>
      W trakcie
      <span class="filter-badge">{{ in_progress_count }}</span>
    </a>
    <a href="?status=resolved" class="filter-tab {% if status_filter == 'resolved' %}active{% endif %}">
      <i class="bi bi-check-circle"></i>
      Rozwiązane
      <span class="filter-badge">{{ resolved_count }}</span>
    </a>
  </div>

  <!-- Reports List -->
  {% for report in page_obj %}
    <div class="admin-report-card" onclick="window.location.href='{% url 'admin_report_detail' report.id %}'">
      <div class="admin-report-header">
        <div style="flex: 1;">
          <div class="admin-report-title">{{ report.title }}</div>
          <div class="admin-report-user">
            <i class="bi bi-person-circle"></i>
            {{ report.user.username }}
          </div>
        </div>
        <span class="report-status-badge status-{{ report.status }}">
          {% if report.status == 'pending' %}
            <i class="bi bi-clock"></i> Oczekujący
          {% elif report.status == 'in_progress' %}
            <i class="bi bi-gear"></i> W trakcie
          {% else %}
            <i class="bi bi-check-circle"></i> Rozwiązany
          {% endif %}
        </span>
      </div>

      <div class="admin-report-description">
        {{ report.description|truncatewords:30 }}
      </div>

      <div class="admin-report-meta">
        <span>
          <i class="bi bi-calendar3"></i>
          {{ report.created_at|date:"d.m.Y H:i" }}
        </span>
        {% if report.page_url %}
          <span>
            <i class="bi bi-link"></i>
            {{ report.page_url|truncatechars:50 }}
          </span>
        {% endif %}
        {% if report.resolved_by %}
          <span>
            <i class="bi bi-person-check"></i>
            Rozwiązane przez: {{ report.resolved_by.username }}
          </span>
        {% endif %}
      </div>
    </div>
  {% empty %}
    <div style="text-align: center; padding: 80px 20px; color: #6b7280;">
      <i class="bi bi-inbox" style="font-size: 64px; margin-bottom: 20px; opacity: 0.3;"></i>
      <h3 style="color: #9aa0a6;">Brak zgłoszeń</h3>
    </div>
  {% endfor %}

  <!-- Pagination -->
  {% if page_obj.has_other_pages %}
    <div class="pagination">
      {% if page_obj.has_previous %}
        <a href="?status={{ status_filter }}&page=1">
          <i class="bi bi-chevron-double-left"></i>
        </a>
        <a href="?status={{ status_filter }}&page={{ page_obj.previous_page_number }}">
          <i class="bi bi-chevron-left"></i>
        </a>
      {% endif %}

      <span class="current">{{ page_obj.number }}</span>

      {% if page_obj.has_next %}
        <a href="?status={{ status_filter }}&page={{ page_obj.next_page_number }}">
          <i class="bi bi-chevron-right"></i>
        </a>
        <a href="?status={{ status_filter }}&page={{ page_obj.paginator.num_pages }}">
          <i class="bi bi-chevron-double-right"></i>
        </a>
      {% endif %}
    </div>
  {% endif %}

</div>

{% endblock %}