{% extends "users/base.html" %}
{% load static %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/users.css' %}">
{% endblock %}

{% block content %}

<div class="container py-4">
  
  <div class="my-reports-header">
    <h1 class="my-reports-title">
      <i class="bi bi-list-ul"></i>
      Moje zgłoszenia
    </h1>
    <p class="my-reports-subtitle">Śledź status swoich zgłoszeń</p>
  </div>

  {% if reports %}
    {% for report in reports %}
      <div class="report-card-item">
        <div class="report-card-header">
          <div style="flex: 1;">
            <div class="report-card-title">{{ report.title }}</div>
          </div>
          <span class="report-status-badge status-{{ report.status }}">
            {% if report.status == 'pending' %}
              <i class="bi bi-clock"></i> Oczekujący
            {% elif report.status == 'in_progress' %}
              <i class="bi bi-gear"></i> W trakcie
            {% else %}
              <i class="bi bi-check-circle"></i> Rozwiązany
            {% endif %}
          </span>
        </div>

        <div class="report-card-description">
          {{ report.description|truncatewords:50 }}
        </div>

        <div class="report-card-meta">
          <span>
            <i class="bi bi-calendar3"></i>
            {{ report.created_at|date:"d.m.Y H:i" }}
          </span>
          {% if report.page_url %}
            <span>
              <i class="bi bi-link"></i>
              Strona: {{ report.page_url|truncatechars:40 }}
            </span>
          {% endif %}
          {% if report.resolved_at %}
            <span>
              <i class="bi bi-check2"></i>
              Rozwiązano: {{ report.resolved_at|date:"d.m.Y" }}
            </span>
          {% endif %}
        </div>

        {% if report.admin_notes %}
          <div class="admin-notes-box">
            <div class="admin-notes-label">
              <i class="bi bi-chat-left-text"></i> Notatka admina:
            </div>
            <div class="admin-notes-text">
              {{ report.admin_notes }}
            </div>
          </div>
        {% endif %}
      </div>
    {% endfor %}
  {% else %}
    <div class="empty-reports">
      <i class="bi bi-inbox"></i>
      <h3>Nie masz jeszcze zgłoszeń</h3>
      <p>Jeśli napotkasz jakiś problem, daj nam znać!</p>
      <a href="{% url 'report_error' %}" class="btn btn-primary">
        <i class="bi bi-exclamation-triangle"></i> Zgłoś problem
      </a>
    </div>
  {% endif %}

</div>

{% endblock %}